[2023-11-06 17:33:53,775: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:33:53,777: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:33:53,780: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:33:53,781: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:33:53,782: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:33:54,080: INFO: common: Data frame created for attack types ]
[2023-11-06 17:33:54,213: INFO: common: Data frame created for malwares ]
[2023-11-06 17:33:54,375: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:33:54,506: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:33:54,641: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:33:54,642: INFO: common: Data frames creation done ]
[2023-11-06 17:33:54,658: INFO: 2204960481: Data_extracted and splitted]
[2023-11-06 17:33:54,686: INFO: common: Table operations performed ]
[2023-11-06 17:33:54,688: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique platforms  \
0      Extra Window Memory Injection             True      None   
1      Extra Window Memory Injection             True      None   
2                     Scheduled Task             True      None   
3                     Scheduled Task             True      None   
4                     Scheduled Task             True      None   
...                              ...              ...       ...   
13940      Process Argument Spoofing             True      None   
13941      Process Argument Spoofing             True      None   
13942           Windows Admin Shares            False      None   
13943                   COR_PROFILER             True      None   
13944                   COR_PROFILER             True      None   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 17:35:49,348: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:35:49,350: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:35:49,351: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:35:49,352: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:35:49,353: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:35:49,650: INFO: common: Data frame created for attack types ]
[2023-11-06 17:35:49,801: INFO: common: Data frame created for malwares ]
[2023-11-06 17:35:49,954: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:35:50,091: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:35:50,228: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:35:50,228: INFO: common: Data frames creation done ]
[2023-11-06 17:35:50,244: INFO: 2204960481: Data_extracted and splitted]
[2023-11-06 17:35:50,275: INFO: common: Table operations performed ]
[2023-11-06 17:35:50,276: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique platforms  \
0      Extra Window Memory Injection             True      None   
1      Extra Window Memory Injection             True      None   
2                     Scheduled Task             True      None   
3                     Scheduled Task             True      None   
4                     Scheduled Task             True      None   
...                              ...              ...       ...   
13940      Process Argument Spoofing             True      None   
13941      Process Argument Spoofing             True      None   
13942           Windows Admin Shares            False      None   
13943                   COR_PROFILER             True      None   
13944                   COR_PROFILER             True      None   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 17:35:55,110: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:35:55,112: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:35:55,114: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:35:55,116: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:35:55,117: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:35:55,428: INFO: common: Data frame created for attack types ]
[2023-11-06 17:35:55,560: INFO: common: Data frame created for malwares ]
[2023-11-06 17:35:55,718: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:35:55,845: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:35:55,983: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:35:55,984: INFO: common: Data frames creation done ]
[2023-11-06 17:35:55,999: INFO: 2204960481: Data_extracted and splitted]
[2023-11-06 17:35:56,028: INFO: common: Table operations performed ]
[2023-11-06 17:35:56,029: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique platforms  \
0      Extra Window Memory Injection             True      None   
1      Extra Window Memory Injection             True      None   
2                     Scheduled Task             True      None   
3                     Scheduled Task             True      None   
4                     Scheduled Task             True      None   
...                              ...              ...       ...   
13940      Process Argument Spoofing             True      None   
13941      Process Argument Spoofing             True      None   
13942           Windows Admin Shares            False      None   
13943                   COR_PROFILER             True      None   
13944                   COR_PROFILER             True      None   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 17:36:18,240: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:36:18,241: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:36:18,243: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:36:18,244: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:36:18,246: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:36:18,564: INFO: common: Data frame created for attack types ]
[2023-11-06 17:36:18,698: INFO: common: Data frame created for malwares ]
[2023-11-06 17:36:18,913: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:36:19,049: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:36:19,185: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:36:19,186: INFO: common: Data frames creation done ]
[2023-11-06 17:36:19,203: INFO: 4100549560: Data_extracted and splitted]
[2023-11-06 17:36:19,234: INFO: common: Table operations performed ]
[2023-11-06 17:36:19,235: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique platforms  \
0      Extra Window Memory Injection             True      None   
1      Extra Window Memory Injection             True      None   
2                     Scheduled Task             True      None   
3                     Scheduled Task             True      None   
4                     Scheduled Task             True      None   
...                              ...              ...       ...   
13940      Process Argument Spoofing             True      None   
13941      Process Argument Spoofing             True      None   
13942           Windows Admin Shares            False      None   
13943                   COR_PROFILER             True      None   
13944                   COR_PROFILER             True      None   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 17:39:18,787: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 17:39:18,790: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:39:18,790: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:39:18,790: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:39:18,791: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:39:18,791: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 17:39:25,435: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 47AE:2A32:1E92CD7:201B04C:654922D0
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 17:39:19 GMT
Via: 1.1 varnish
X-Served-By: cache-man4129-MAN
X-Cache: HIT
X-Cache-Hits: 0
X-Timer: S1699292359.885650,VS0,VE168
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: 613e73532d636b285e0ec5c01e5d9416a9bfbf25
Expires: Mon, 06 Nov 2023 17:44:19 GMT
Source-Age: 0

]
[2023-11-06 17:39:25,436: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 17:39:25,436: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 17:39:25,437: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:39:25,437: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:39:25,438: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:39:25,439: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:39:25,439: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:39:25,765: INFO: common: Data frame created for attack types ]
[2023-11-06 17:39:25,902: INFO: common: Data frame created for malwares ]
[2023-11-06 17:39:26,079: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:39:26,214: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:39:26,353: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:39:26,353: INFO: common: Data frames creation done ]
[2023-11-06 17:39:26,367: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 17:39:26,398: INFO: common: Table operations performed ]
[2023-11-06 17:39:26,398: INFO: common:                                                attack_id  ... campaign_name
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
...                                                  ...  ...           ...
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...  ...           NaN
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN

[13945 rows x 11 columns]]
[2023-11-06 17:39:26,416: ERROR: main: unhashable type: 'list']
Traceback (most recent call last):
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1770, in apply
    result = self._python_apply_general(f, self._selected_obj)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1819, in _python_apply_general
    values, mutated = self.grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 888, in apply_groupwise
    splitter = self._get_splitter(data, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 613, in _get_splitter
    ids, _, ngroups = self.group_info
                      ^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 729, in group_info
    comp_ids, obs_group_ids = self._get_compressed_codes()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 748, in _get_compressed_codes
    group_index = get_group_index(self.codes, self.shape, sort=True, xnull=True)
                                  ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 674, in codes
    return [ping.codes for ping in self.groupings]
            ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 691, in codes
    return self._codes_and_uniques[0]
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 801, in _codes_and_uniques
    codes, uniques = algorithms.factorize(  # type: ignore[assignment]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 795, in factorize
    codes, uniques = factorize_array(
                     ^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 595, in factorize_array
    uniques, codes = table.factorize(
                     ^^^^^^^^^^^^^^^^
  File "pandas\_libs\hashtable_class_helper.pxi", line 7280, in pandas._libs.hashtable.PyObjectHashTable.factorize
  File "pandas\_libs\hashtable_class_helper.pxi", line 7194, in pandas._libs.hashtable.PyObjectHashTable._unique
TypeError: unhashable type: 'list'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ESP_workspace\ESP\main.py", line 25, in <module>
    obj.main()
  File "d:\ESP_workspace\ESP\src\mlProject\pipeline\data_transformation.py", line 15, in main
    data_transformation.extract_split()
  File "d:\ESP_workspace\ESP\src\mlProject\components\data_transformation.py", line 21, in extract_split
    attack_to_adversery(df_attack,df_relationship,df_intrusion,df_campaign,Path(self.config.JSON_extract))
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\ensure\main.py", line 835, in __call__
    return self.f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\ESP_workspace\ESP\src\mlProject\utils\common.py", line 228, in attack_to_adversery
    result_js = merge_2.groupby(['attack_id', 'attack_name', 'is_subtechnique','platforms']).apply(group_rows).reset_index()#.to_dict()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1780, in apply
    return self._python_apply_general(f, self._obj_with_exclusions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1819, in _python_apply_general
    values, mutated = self.grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 888, in apply_groupwise
    splitter = self._get_splitter(data, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 613, in _get_splitter
    ids, _, ngroups = self.group_info
                      ^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 729, in group_info
    comp_ids, obs_group_ids = self._get_compressed_codes()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 748, in _get_compressed_codes
    group_index = get_group_index(self.codes, self.shape, sort=True, xnull=True)
                                  ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 674, in codes
    return [ping.codes for ping in self.groupings]
            ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 691, in codes
    return self._codes_and_uniques[0]
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 801, in _codes_and_uniques
    codes, uniques = algorithms.factorize(  # type: ignore[assignment]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 795, in factorize
    codes, uniques = factorize_array(
                     ^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 595, in factorize_array
    uniques, codes = table.factorize(
                     ^^^^^^^^^^^^^^^^
  File "pandas\_libs\hashtable_class_helper.pxi", line 7280, in pandas._libs.hashtable.PyObjectHashTable.factorize
  File "pandas\_libs\hashtable_class_helper.pxi", line 7194, in pandas._libs.hashtable.PyObjectHashTable._unique
TypeError: unhashable type: 'list'
[2023-11-06 17:42:14,833: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:42:14,835: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:42:14,837: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:42:14,839: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:42:14,840: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:42:15,143: INFO: common: Data frame created for attack types ]
[2023-11-06 17:42:15,272: INFO: common: Data frame created for malwares ]
[2023-11-06 17:42:15,434: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:42:15,565: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:42:15,698: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:42:15,698: INFO: common: Data frames creation done ]
[2023-11-06 17:42:15,712: INFO: 4100549560: Data_extracted and splitted]
[2023-11-06 17:42:15,742: INFO: common: Table operations performed ]
[2023-11-06 17:42:15,743: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique  platforms  \
0      Extra Window Memory Injection             True  [Windows]   
1      Extra Window Memory Injection             True  [Windows]   
2                     Scheduled Task             True  [Windows]   
3                     Scheduled Task             True  [Windows]   
4                     Scheduled Task             True  [Windows]   
...                              ...              ...        ...   
13940      Process Argument Spoofing             True  [Windows]   
13941      Process Argument Spoofing             True  [Windows]   
13942           Windows Admin Shares            False  [Windows]   
13943                   COR_PROFILER             True  [Windows]   
13944                   COR_PROFILER             True  [Windows]   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 17:42:24,670: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:42:24,673: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:42:24,674: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:42:24,676: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:42:24,677: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:42:25,002: INFO: common: Data frame created for attack types ]
[2023-11-06 17:42:25,133: INFO: common: Data frame created for malwares ]
[2023-11-06 17:42:25,379: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:42:25,508: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:42:25,636: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:42:25,637: INFO: common: Data frames creation done ]
[2023-11-06 17:42:25,653: INFO: 4100549560: Data_extracted and splitted]
[2023-11-06 17:42:25,683: INFO: common: Table operations performed ]
[2023-11-06 17:42:25,684: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique  platforms  \
0      Extra Window Memory Injection             True  [Windows]   
1      Extra Window Memory Injection             True  [Windows]   
2                     Scheduled Task             True  [Windows]   
3                     Scheduled Task             True  [Windows]   
4                     Scheduled Task             True  [Windows]   
...                              ...              ...        ...   
13940      Process Argument Spoofing             True  [Windows]   
13941      Process Argument Spoofing             True  [Windows]   
13942           Windows Admin Shares            False  [Windows]   
13943                   COR_PROFILER             True  [Windows]   
13944                   COR_PROFILER             True  [Windows]   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 17:43:22,644: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 17:43:22,647: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 17:43:22,648: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 17:43:22,651: INFO: common: created directory at: artifacts_root]
[2023-11-06 17:43:22,652: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 17:43:22,966: INFO: common: Data frame created for attack types ]
[2023-11-06 17:43:23,099: INFO: common: Data frame created for malwares ]
[2023-11-06 17:43:23,286: INFO: common: Data frame created for relationship types ]
[2023-11-06 17:43:23,417: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 17:43:23,544: INFO: common: Data frame created for campaign types ]
[2023-11-06 17:43:23,545: INFO: common: Data frames creation done ]
[2023-11-06 17:43:23,558: INFO: 4100549560: Data_extracted and splitted]
[2023-11-06 17:43:23,585: INFO: common: Table operations performed ]
[2023-11-06 17:43:23,587: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique  platforms  \
0      Extra Window Memory Injection             True  [Windows]   
1      Extra Window Memory Injection             True  [Windows]   
2                     Scheduled Task             True  [Windows]   
3                     Scheduled Task             True  [Windows]   
4                     Scheduled Task             True  [Windows]   
...                              ...              ...        ...   
13940      Process Argument Spoofing             True  [Windows]   
13941      Process Argument Spoofing             True  [Windows]   
13942           Windows Admin Shares            False  [Windows]   
13943                   COR_PROFILER             True  [Windows]   
13944                   COR_PROFILER             True  [Windows]   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 18:39:55,343: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 18:39:55,344: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:39:55,345: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:39:55,345: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:39:55,345: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:39:55,346: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 18:40:11,883: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 6B32:463A:1FFFEF6:2185FF3:654932FB
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 18:39:57 GMT
Via: 1.1 varnish
X-Served-By: cache-man4146-MAN
X-Cache: MISS
X-Cache-Hits: 0
X-Timer: S1699295995.425906,VS0,VE1623
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: 81372a0488dcbc60709e55d7d4d8c905dacc7365
Expires: Mon, 06 Nov 2023 18:44:57 GMT
Source-Age: 1

]
[2023-11-06 18:40:11,883: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 18:40:11,883: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 18:40:11,884: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:40:11,885: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:40:11,885: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:40:11,885: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:40:11,886: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:40:12,223: INFO: common: Data frame created for attack types ]
[2023-11-06 18:40:12,363: INFO: common: Data frame created for malwares ]
[2023-11-06 18:40:12,562: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:40:12,694: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:40:12,826: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:40:12,826: INFO: common: Data frames creation done ]
[2023-11-06 18:40:12,841: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 18:40:12,852: INFO: common: Table operations performed ]
[2023-11-06 18:40:12,852: INFO: common:                                              platforms  ... campaign_name
0    attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
1    attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
2    attack-pattern--005cc321-08ce-4d17-b1ea-cb5275...  ...           NaN
3    attack-pattern--00d0b012-8a03-410e-95de-5826bf...  ...           NaN
4    attack-pattern--00f90846-cbd1-4fc5-9233-df5c2b...  ...           NaN
..                                                 ...  ...           ...
763  attack-pattern--ff73aa03-0090-4464-83ac-f89e23...  ...           NaN
764  attack-pattern--ffbcfdb0-de22-4106-9ed3-fc23c8...  ...           NaN
765  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
766  attack-pattern--ffe742ed-9100-4686-9e00-c331da...  ...           NaN
767  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN

[768 rows x 11 columns]]
[2023-11-06 18:40:12,874: ERROR: main: unhashable type: 'list']
Traceback (most recent call last):
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1770, in apply
    result = self._python_apply_general(f, self._selected_obj)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1819, in _python_apply_general
    values, mutated = self.grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 888, in apply_groupwise
    splitter = self._get_splitter(data, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 613, in _get_splitter
    ids, _, ngroups = self.group_info
                      ^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 729, in group_info
    comp_ids, obs_group_ids = self._get_compressed_codes()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 748, in _get_compressed_codes
    group_index = get_group_index(self.codes, self.shape, sort=True, xnull=True)
                                  ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 674, in codes
    return [ping.codes for ping in self.groupings]
            ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 691, in codes
    return self._codes_and_uniques[0]
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 801, in _codes_and_uniques
    codes, uniques = algorithms.factorize(  # type: ignore[assignment]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 795, in factorize
    codes, uniques = factorize_array(
                     ^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 595, in factorize_array
    uniques, codes = table.factorize(
                     ^^^^^^^^^^^^^^^^
  File "pandas\_libs\hashtable_class_helper.pxi", line 7280, in pandas._libs.hashtable.PyObjectHashTable.factorize
  File "pandas\_libs\hashtable_class_helper.pxi", line 7194, in pandas._libs.hashtable.PyObjectHashTable._unique
TypeError: unhashable type: 'list'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ESP_workspace\ESP\main.py", line 25, in <module>
    obj.main()
  File "d:\ESP_workspace\ESP\src\mlProject\pipeline\data_transformation.py", line 15, in main
    data_transformation.extract_split()
  File "d:\ESP_workspace\ESP\src\mlProject\components\data_transformation.py", line 21, in extract_split
    attack_to_adversery(df_attack,df_relationship,df_intrusion,df_campaign,Path(self.config.JSON_extract))
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\ensure\main.py", line 835, in __call__
    return self.f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\ESP_workspace\ESP\src\mlProject\utils\common.py", line 228, in attack_to_adversery
    result_js = merge_2.groupby(['attack_id', 'attack_name', 'is_subtechnique','platforms']).apply(group_rows).reset_index()#.to_dict()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1780, in apply
    return self._python_apply_general(f, self._obj_with_exclusions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1819, in _python_apply_general
    values, mutated = self.grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 888, in apply_groupwise
    splitter = self._get_splitter(data, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 613, in _get_splitter
    ids, _, ngroups = self.group_info
                      ^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 729, in group_info
    comp_ids, obs_group_ids = self._get_compressed_codes()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 748, in _get_compressed_codes
    group_index = get_group_index(self.codes, self.shape, sort=True, xnull=True)
                                  ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 674, in codes
    return [ping.codes for ping in self.groupings]
            ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 691, in codes
    return self._codes_and_uniques[0]
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 801, in _codes_and_uniques
    codes, uniques = algorithms.factorize(  # type: ignore[assignment]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 795, in factorize
    codes, uniques = factorize_array(
                     ^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 595, in factorize_array
    uniques, codes = table.factorize(
                     ^^^^^^^^^^^^^^^^
  File "pandas\_libs\hashtable_class_helper.pxi", line 7280, in pandas._libs.hashtable.PyObjectHashTable.factorize
  File "pandas\_libs\hashtable_class_helper.pxi", line 7194, in pandas._libs.hashtable.PyObjectHashTable._unique
TypeError: unhashable type: 'list'
[2023-11-06 18:42:17,768: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:42:17,771: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:42:17,772: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:42:17,774: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:42:17,776: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:42:18,133: INFO: common: Data frame created for attack types ]
[2023-11-06 18:42:18,262: INFO: common: Data frame created for malwares ]
[2023-11-06 18:42:18,560: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:42:18,691: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:42:18,823: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:42:18,824: INFO: common: Data frames creation done ]
[2023-11-06 18:42:18,838: INFO: 4100549560: Data_extracted and splitted]
[2023-11-06 18:42:18,871: INFO: common: Table operations performed ]
[2023-11-06 18:42:18,872: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique  platforms  \
0      Extra Window Memory Injection             True  [Windows]   
1      Extra Window Memory Injection             True  [Windows]   
2                     Scheduled Task             True  [Windows]   
3                     Scheduled Task             True  [Windows]   
4                     Scheduled Task             True  [Windows]   
...                              ...              ...        ...   
13940      Process Argument Spoofing             True  [Windows]   
13941      Process Argument Spoofing             True  [Windows]   
13942           Windows Admin Shares            False  [Windows]   
13943                   COR_PROFILER             True  [Windows]   
13944                   COR_PROFILER             True  [Windows]   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 18:45:15,735: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:45:15,737: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:45:15,738: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:45:15,740: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:45:15,741: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:45:16,024: INFO: common: Data frame created for attack types ]
[2023-11-06 18:45:16,160: INFO: common: Data frame created for malwares ]
[2023-11-06 18:45:16,308: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:45:16,466: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:45:16,600: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:45:16,601: INFO: common: Data frames creation done ]
[2023-11-06 18:45:16,617: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:45:16,658: INFO: common: Table operations performed ]
[2023-11-06 18:45:16,658: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique  platforms  \
0      Extra Window Memory Injection             True  [Windows]   
1      Extra Window Memory Injection             True  [Windows]   
2                     Scheduled Task             True  [Windows]   
3                     Scheduled Task             True  [Windows]   
4                     Scheduled Task             True  [Windows]   
...                              ...              ...        ...   
13940      Process Argument Spoofing             True  [Windows]   
13941      Process Argument Spoofing             True  [Windows]   
13942           Windows Admin Shares            False  [Windows]   
13943                   COR_PROFILER             True  [Windows]   
13944                   COR_PROFILER             True  [Windows]   

      relationship_type                                         source_ref  \
0                  uses      malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1                  uses      malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2                  uses      malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3                  uses      malware--f559f945-eb8b-48b1-904c-68568deebed3   
4                  uses      malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                 ...                                                ...   
13940              uses      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941              uses      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942               NaN                                                NaN   
13943              uses  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944              uses      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 18:47:16,834: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:47:16,837: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:47:16,840: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:47:16,842: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:47:16,843: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:47:17,252: INFO: common: Data frame created for attack types ]
[2023-11-06 18:47:17,392: INFO: common: Data frame created for malwares ]
[2023-11-06 18:47:17,568: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:47:17,708: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:47:17,850: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:47:17,851: INFO: common: Data frames creation done ]
[2023-11-06 18:47:17,870: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:47:17,892: INFO: common: Table operations performed ]
[2023-11-06 18:47:17,893: INFO: common:                                              platforms  \
0    attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1    attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
2    attack-pattern--005cc321-08ce-4d17-b1ea-cb5275...   
3    attack-pattern--00d0b012-8a03-410e-95de-5826bf...   
4    attack-pattern--00f90846-cbd1-4fc5-9233-df5c2b...   
..                                                 ...   
763  attack-pattern--ff73aa03-0090-4464-83ac-f89e23...   
764  attack-pattern--ffbcfdb0-de22-4106-9ed3-fc23c8...   
765  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
766  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
767  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_id  attack_name  \
0    Extra Window Memory Injection         True   
1                   Scheduled Task         True   
2                   Socket Filters         True   
3     Indicator Removal from Tools        False   
4              Archive via Utility         True   
..                             ...          ...   
763         System Shutdown/Reboot        False   
764                            MMC         True   
765      Process Argument Spoofing         True   
766           Windows Admin Shares        False   
767                   COR_PROFILER         True   

                      is_subtechnique relationship_type source_ref target_ref  \
0                           [Windows]               NaN        NaN        NaN   
1                           [Windows]               NaN        NaN        NaN   
2             [Linux, macOS, Windows]               NaN        NaN        NaN   
3             [Linux, macOS, Windows]               NaN        NaN        NaN   
4             [Linux, macOS, Windows]               NaN        NaN        NaN   
..                                ...               ...        ...        ...   
763  [Linux, macOS, Windows, Network]               NaN        NaN        NaN   
764                         [Windows]               NaN        NaN        NaN   
765                         [Windows]               NaN        NaN        NaN   
766                         [Windows]               NaN        NaN        NaN   
767                         [Windows]               NaN        NaN        NaN   

    intrusion_id intrusion_name campaign_id campaign_name  
0            NaN            NaN         NaN           NaN  
1            NaN            NaN         NaN           NaN  
2            NaN            NaN         NaN           NaN  
3            NaN            NaN         NaN           NaN  
4            NaN            NaN         NaN           NaN  
..           ...            ...         ...           ...  
763          NaN            NaN         NaN           NaN  
764          NaN            NaN         NaN           NaN  
765          NaN            NaN         NaN           NaN  
766          NaN            NaN         NaN           NaN  
767          NaN            NaN         NaN           NaN  

[768 rows x 11 columns]]
[2023-11-06 18:47:34,195: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:47:34,197: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:47:34,198: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:47:34,200: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:47:34,201: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:47:34,535: INFO: common: Data frame created for attack types ]
[2023-11-06 18:47:34,669: INFO: common: Data frame created for malwares ]
[2023-11-06 18:47:34,834: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:47:34,966: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:47:35,096: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:47:35,097: INFO: common: Data frames creation done ]
[2023-11-06 18:47:35,111: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:47:35,131: INFO: common: Table operations performed ]
[2023-11-06 18:47:35,132: INFO: common:                                              platforms  \
0    attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1    attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
2    attack-pattern--005cc321-08ce-4d17-b1ea-cb5275...   
3    attack-pattern--00d0b012-8a03-410e-95de-5826bf...   
4    attack-pattern--00f90846-cbd1-4fc5-9233-df5c2b...   
..                                                 ...   
763  attack-pattern--ff73aa03-0090-4464-83ac-f89e23...   
764  attack-pattern--ffbcfdb0-de22-4106-9ed3-fc23c8...   
765  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
766  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
767  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_id  attack_name  \
0    Extra Window Memory Injection         True   
1                   Scheduled Task         True   
2                   Socket Filters         True   
3     Indicator Removal from Tools        False   
4              Archive via Utility         True   
..                             ...          ...   
763         System Shutdown/Reboot        False   
764                            MMC         True   
765      Process Argument Spoofing         True   
766           Windows Admin Shares        False   
767                   COR_PROFILER         True   

                      is_subtechnique relationship_type source_ref target_ref  \
0                           [Windows]               NaN        NaN        NaN   
1                           [Windows]               NaN        NaN        NaN   
2             [Linux, macOS, Windows]               NaN        NaN        NaN   
3             [Linux, macOS, Windows]               NaN        NaN        NaN   
4             [Linux, macOS, Windows]               NaN        NaN        NaN   
..                                ...               ...        ...        ...   
763  [Linux, macOS, Windows, Network]               NaN        NaN        NaN   
764                         [Windows]               NaN        NaN        NaN   
765                         [Windows]               NaN        NaN        NaN   
766                         [Windows]               NaN        NaN        NaN   
767                         [Windows]               NaN        NaN        NaN   

    intrusion_id intrusion_name campaign_id campaign_name  
0            NaN            NaN         NaN           NaN  
1            NaN            NaN         NaN           NaN  
2            NaN            NaN         NaN           NaN  
3            NaN            NaN         NaN           NaN  
4            NaN            NaN         NaN           NaN  
..           ...            ...         ...           ...  
763          NaN            NaN         NaN           NaN  
764          NaN            NaN         NaN           NaN  
765          NaN            NaN         NaN           NaN  
766          NaN            NaN         NaN           NaN  
767          NaN            NaN         NaN           NaN  

[768 rows x 11 columns]]
[2023-11-06 18:50:05,469: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:50:05,472: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:50:05,473: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:50:05,475: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:50:05,476: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:50:05,783: INFO: common: Data frame created for attack types ]
[2023-11-06 18:50:05,909: INFO: common: Data frame created for malwares ]
[2023-11-06 18:50:06,087: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:50:06,217: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:50:06,342: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:50:06,343: INFO: common: Data frames creation done ]
[2023-11-06 18:50:06,357: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:50:06,375: INFO: common: Table operations performed ]
[2023-11-06 18:50:06,376: INFO: common:                                              platforms  \
0    attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1    attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
2    attack-pattern--005cc321-08ce-4d17-b1ea-cb5275...   
3    attack-pattern--00d0b012-8a03-410e-95de-5826bf...   
4    attack-pattern--00f90846-cbd1-4fc5-9233-df5c2b...   
..                                                 ...   
763  attack-pattern--ff73aa03-0090-4464-83ac-f89e23...   
764  attack-pattern--ffbcfdb0-de22-4106-9ed3-fc23c8...   
765  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
766  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
767  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_id  attack_name  \
0    Extra Window Memory Injection         True   
1                   Scheduled Task         True   
2                   Socket Filters         True   
3     Indicator Removal from Tools        False   
4              Archive via Utility         True   
..                             ...          ...   
763         System Shutdown/Reboot        False   
764                            MMC         True   
765      Process Argument Spoofing         True   
766           Windows Admin Shares        False   
767                   COR_PROFILER         True   

                      is_subtechnique relationship_type source_ref target_ref  \
0                           [Windows]               NaN        NaN        NaN   
1                           [Windows]               NaN        NaN        NaN   
2             [Linux, macOS, Windows]               NaN        NaN        NaN   
3             [Linux, macOS, Windows]               NaN        NaN        NaN   
4             [Linux, macOS, Windows]               NaN        NaN        NaN   
..                                ...               ...        ...        ...   
763  [Linux, macOS, Windows, Network]               NaN        NaN        NaN   
764                         [Windows]               NaN        NaN        NaN   
765                         [Windows]               NaN        NaN        NaN   
766                         [Windows]               NaN        NaN        NaN   
767                         [Windows]               NaN        NaN        NaN   

    intrusion_id intrusion_name campaign_id campaign_name  
0            NaN            NaN         NaN           NaN  
1            NaN            NaN         NaN           NaN  
2            NaN            NaN         NaN           NaN  
3            NaN            NaN         NaN           NaN  
4            NaN            NaN         NaN           NaN  
..           ...            ...         ...           ...  
763          NaN            NaN         NaN           NaN  
764          NaN            NaN         NaN           NaN  
765          NaN            NaN         NaN           NaN  
766          NaN            NaN         NaN           NaN  
767          NaN            NaN         NaN           NaN  

[768 rows x 11 columns]]
[2023-11-06 18:52:42,744: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:52:42,746: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:52:42,748: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:52:42,750: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:52:42,751: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:52:43,051: INFO: common: Data frame created for attack types ]
[2023-11-06 18:52:43,179: INFO: common: Data frame created for malwares ]
[2023-11-06 18:52:43,344: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:52:43,475: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:52:43,603: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:52:43,604: INFO: common: Data frames creation done ]
[2023-11-06 18:52:43,619: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:52:43,652: INFO: common: Table operations performed ]
[2023-11-06 18:52:43,653: INFO: common:        platforms                                          attack_id  \
0      [Windows]  attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      [Windows]  attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      [Windows]  attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      [Windows]  attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      [Windows]  attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...          ...                                                ...   
13940  [Windows]  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  [Windows]  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  [Windows]  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  [Windows]  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  [Windows]  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique relationship_type  \
0      Extra Window Memory Injection             True              uses   
1      Extra Window Memory Injection             True              uses   
2                     Scheduled Task             True              uses   
3                     Scheduled Task             True              uses   
4                     Scheduled Task             True              uses   
...                              ...              ...               ...   
13940      Process Argument Spoofing             True              uses   
13941      Process Argument Spoofing             True              uses   
13942           Windows Admin Shares            False               NaN   
13943                   COR_PROFILER             True              uses   
13944                   COR_PROFILER             True              uses   

                                              source_ref  \
0          malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1          malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2          malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3          malware--f559f945-eb8b-48b1-904c-68568deebed3   
4          malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                                                  ...   
13940      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942                                                NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 18:54:40,025: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:54:40,026: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:54:40,028: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:54:40,029: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:54:40,031: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:54:40,334: INFO: common: Data frame created for attack types ]
[2023-11-06 18:54:40,463: INFO: common: Data frame created for malwares ]
[2023-11-06 18:54:40,626: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:54:40,751: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:54:40,879: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:54:40,880: INFO: common: Data frames creation done ]
[2023-11-06 18:54:40,894: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:54:40,931: INFO: common: Table operations performed ]
[2023-11-06 18:54:40,932: INFO: common:        platforms                                          attack_id  \
0      [Windows]  attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      [Windows]  attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      [Windows]  attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      [Windows]  attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      [Windows]  attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...          ...                                                ...   
13940  [Windows]  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  [Windows]  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  [Windows]  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  [Windows]  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  [Windows]  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique relationship_type  \
0      Extra Window Memory Injection             True              uses   
1      Extra Window Memory Injection             True              uses   
2                     Scheduled Task             True              uses   
3                     Scheduled Task             True              uses   
4                     Scheduled Task             True              uses   
...                              ...              ...               ...   
13940      Process Argument Spoofing             True              uses   
13941      Process Argument Spoofing             True              uses   
13942           Windows Admin Shares            False               NaN   
13943                   COR_PROFILER             True              uses   
13944                   COR_PROFILER             True              uses   

                                              source_ref  \
0          malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1          malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2          malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3          malware--f559f945-eb8b-48b1-904c-68568deebed3   
4          malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                                                  ...   
13940      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942                                                NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 11 columns]]
[2023-11-06 18:55:20,816: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 18:55:20,817: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:55:20,817: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:55:20,817: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:55:20,818: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:55:20,818: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 18:55:36,923: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 6B32:463A:1FFFEF6:2185FF3:654932FB
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 18:55:20 GMT
Via: 1.1 varnish
X-Served-By: cache-man4132-MAN
X-Cache: HIT
X-Cache-Hits: 0
X-Timer: S1699296921.884285,VS0,VE104
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: ad64cb2d3952e4625c103323a4db859811703d92
Expires: Mon, 06 Nov 2023 19:00:20 GMT
Source-Age: 0

]
[2023-11-06 18:55:36,923: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 18:55:36,923: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 18:55:36,924: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:55:36,925: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:55:36,925: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:55:36,926: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:55:36,926: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:55:37,252: INFO: common: Data frame created for attack types ]
[2023-11-06 18:55:37,393: INFO: common: Data frame created for malwares ]
[2023-11-06 18:55:37,563: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:55:37,695: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:55:37,842: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:55:37,842: INFO: common: Data frames creation done ]
[2023-11-06 18:55:37,857: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 18:55:37,900: INFO: common: Table operations performed ]
[2023-11-06 18:55:37,900: INFO: common:        platforms  ... campaign_name
0      [Windows]  ...           NaN
1      [Windows]  ...           NaN
2      [Windows]  ...           NaN
3      [Windows]  ...           NaN
4      [Windows]  ...           NaN
...          ...  ...           ...
13940  [Windows]  ...           NaN
13941  [Windows]  ...           NaN
13942  [Windows]  ...           NaN
13943  [Windows]  ...           NaN
13944  [Windows]  ...           NaN

[13945 rows x 11 columns]]
[2023-11-06 18:55:37,933: ERROR: main: [Errno 13] Permission denied: 'f2.csv']
Traceback (most recent call last):
  File "d:\ESP_workspace\ESP\main.py", line 25, in <module>
    obj.main()
  File "d:\ESP_workspace\ESP\src\mlProject\pipeline\data_transformation.py", line 15, in main
    data_transformation.extract_split()
  File "d:\ESP_workspace\ESP\src\mlProject\components\data_transformation.py", line 21, in extract_split
    attack_to_adversery(df_attack,df_relationship,df_intrusion,df_campaign,Path(self.config.JSON_extract))
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\ensure\main.py", line 835, in __call__
    return self.f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\ESP_workspace\ESP\src\mlProject\utils\common.py", line 228, in attack_to_adversery
    merge_2.to_csv('f2.csv')
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\generic.py", line 3902, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\io\formats\format.py", line 1152, in to_csv
    csv_formatter.save()
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\io\formats\csvs.py", line 247, in save
    with get_handle(
         ^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\io\common.py", line 863, in get_handle
    handle = open(
             ^^^^^
PermissionError: [Errno 13] Permission denied: 'f2.csv'
[2023-11-06 18:56:04,156: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 18:56:04,158: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:56:04,158: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:56:04,159: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:56:04,159: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:56:04,160: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 18:56:17,316: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 6B32:463A:1FFFEF6:2185FF3:654932FB
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 18:56:04 GMT
Via: 1.1 varnish
X-Served-By: cache-man4146-MAN
X-Cache: HIT
X-Cache-Hits: 1
X-Timer: S1699296964.299847,VS0,VE50
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: 7157bb251e720fef99b55e1d5cfa3e33d09aff59
Expires: Mon, 06 Nov 2023 19:01:04 GMT
Source-Age: 43

]
[2023-11-06 18:56:17,316: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 18:56:17,316: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 18:56:17,317: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:56:17,318: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:56:17,318: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:56:17,319: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:56:17,319: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:56:17,634: INFO: common: Data frame created for attack types ]
[2023-11-06 18:56:17,766: INFO: common: Data frame created for malwares ]
[2023-11-06 18:56:17,932: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:56:18,080: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:56:18,224: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:56:18,225: INFO: common: Data frames creation done ]
[2023-11-06 18:56:18,243: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 18:56:18,273: INFO: common: Table operations performed ]
[2023-11-06 18:56:18,274: INFO: common:        platforms  ... campaign_name
0      [Windows]  ...           NaN
1      [Windows]  ...           NaN
2      [Windows]  ...           NaN
3      [Windows]  ...           NaN
4      [Windows]  ...           NaN
...          ...  ...           ...
13940  [Windows]  ...           NaN
13941  [Windows]  ...           NaN
13942  [Windows]  ...           NaN
13943  [Windows]  ...           NaN
13944  [Windows]  ...           NaN

[13945 rows x 11 columns]]
[2023-11-06 18:56:18,358: ERROR: main: unhashable type: 'list']
Traceback (most recent call last):
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1770, in apply
    result = self._python_apply_general(f, self._selected_obj)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1819, in _python_apply_general
    values, mutated = self.grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 888, in apply_groupwise
    splitter = self._get_splitter(data, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 613, in _get_splitter
    ids, _, ngroups = self.group_info
                      ^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 729, in group_info
    comp_ids, obs_group_ids = self._get_compressed_codes()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 748, in _get_compressed_codes
    group_index = get_group_index(self.codes, self.shape, sort=True, xnull=True)
                                  ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 674, in codes
    return [ping.codes for ping in self.groupings]
            ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 691, in codes
    return self._codes_and_uniques[0]
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 801, in _codes_and_uniques
    codes, uniques = algorithms.factorize(  # type: ignore[assignment]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 795, in factorize
    codes, uniques = factorize_array(
                     ^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 595, in factorize_array
    uniques, codes = table.factorize(
                     ^^^^^^^^^^^^^^^^
  File "pandas\_libs\hashtable_class_helper.pxi", line 7280, in pandas._libs.hashtable.PyObjectHashTable.factorize
  File "pandas\_libs\hashtable_class_helper.pxi", line 7194, in pandas._libs.hashtable.PyObjectHashTable._unique
TypeError: unhashable type: 'list'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ESP_workspace\ESP\main.py", line 25, in <module>
    obj.main()
  File "d:\ESP_workspace\ESP\src\mlProject\pipeline\data_transformation.py", line 15, in main
    data_transformation.extract_split()
  File "d:\ESP_workspace\ESP\src\mlProject\components\data_transformation.py", line 21, in extract_split
    attack_to_adversery(df_attack,df_relationship,df_intrusion,df_campaign,Path(self.config.JSON_extract))
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\ensure\main.py", line 835, in __call__
    return self.f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\ESP_workspace\ESP\src\mlProject\utils\common.py", line 229, in attack_to_adversery
    result_js = merge_2.groupby(['attack_id', 'attack_name', 'is_subtechnique','platforms']).apply(group_rows).reset_index()#.to_dict()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1780, in apply
    return self._python_apply_general(f, self._obj_with_exclusions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\groupby.py", line 1819, in _python_apply_general
    values, mutated = self.grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 888, in apply_groupwise
    splitter = self._get_splitter(data, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 613, in _get_splitter
    ids, _, ngroups = self.group_info
                      ^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 729, in group_info
    comp_ids, obs_group_ids = self._get_compressed_codes()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 748, in _get_compressed_codes
    group_index = get_group_index(self.codes, self.shape, sort=True, xnull=True)
                                  ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\ops.py", line 674, in codes
    return [ping.codes for ping in self.groupings]
            ^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 691, in codes
    return self._codes_and_uniques[0]
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 36, in pandas._libs.properties.CachedProperty.__get__
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\groupby\grouper.py", line 801, in _codes_and_uniques
    codes, uniques = algorithms.factorize(  # type: ignore[assignment]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 795, in factorize
    codes, uniques = factorize_array(
                     ^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\pandas\core\algorithms.py", line 595, in factorize_array
    uniques, codes = table.factorize(
                     ^^^^^^^^^^^^^^^^
  File "pandas\_libs\hashtable_class_helper.pxi", line 7280, in pandas._libs.hashtable.PyObjectHashTable.factorize
  File "pandas\_libs\hashtable_class_helper.pxi", line 7194, in pandas._libs.hashtable.PyObjectHashTable._unique
TypeError: unhashable type: 'list'
[2023-11-06 18:59:00,091: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 18:59:00,094: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 18:59:00,096: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 18:59:00,097: INFO: common: created directory at: artifacts_root]
[2023-11-06 18:59:00,099: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 18:59:00,398: INFO: common: Data frame created for attack types ]
[2023-11-06 18:59:00,526: INFO: common: Data frame created for malwares ]
[2023-11-06 18:59:00,685: INFO: common: Data frame created for relationship types ]
[2023-11-06 18:59:00,815: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 18:59:00,943: INFO: common: Data frame created for campaign types ]
[2023-11-06 18:59:00,944: INFO: common: Data frames creation done ]
[2023-11-06 18:59:00,957: INFO: 2607240163: Data_extracted and splitted]
[2023-11-06 18:59:00,991: INFO: common: Table operations performed ]
[2023-11-06 18:59:00,992: INFO: common:                                                attack_id  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                         attack_name  is_subtechnique relationship_type  \
0      Extra Window Memory Injection             True              uses   
1      Extra Window Memory Injection             True              uses   
2                     Scheduled Task             True              uses   
3                     Scheduled Task             True              uses   
4                     Scheduled Task             True              uses   
...                              ...              ...               ...   
13940      Process Argument Spoofing             True              uses   
13941      Process Argument Spoofing             True              uses   
13942           Windows Admin Shares            False               NaN   
13943                   COR_PROFILER             True              uses   
13944                   COR_PROFILER             True              uses   

                                              source_ref  \
0          malware--6b62e336-176f-417b-856a-8552dd8c44e1   
1          malware--0a9c51e0-825d-4b9b-969d-ce86ed8ce3c3   
2          malware--5c747acd-47f0-4c5a-b9e5-213541fc01e0   
3          malware--f559f945-eb8b-48b1-904c-68568deebed3   
4          malware--d1b7830a-fced-4be3-a99c-f495af9d9e1b   
...                                                  ...   
13940      malware--a7881f21-e978-4fe4-af56-92c9416a2616   
13941      malware--425771c5-48b4-4ecd-9f95-74ed3fc9da59   
13942                                                NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...   
13944      malware--5faaf81a-aa5b-4a4b-bae5-522439e068f8   

                                              target_ref  \
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...   
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...   
...                                                  ...   
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...   
13942                                                NaN   
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...   

                                            intrusion_id    intrusion_name  \
0                                                    NaN               NaN   
1                                                    NaN               NaN   
2                                                    NaN               NaN   
3                                                    NaN               NaN   
4                                                    NaN               NaN   
...                                                  ...               ...   
13940                                                NaN               NaN   
13941                                                NaN               NaN   
13942                                                NaN               NaN   
13943  intrusion-set--73a80fab-2aa3-48e0-a4d0-3a48282...  Blue Mockingbird   
13944                                                NaN               NaN   

      campaign_id campaign_name  
0             NaN           NaN  
1             NaN           NaN  
2             NaN           NaN  
3             NaN           NaN  
4             NaN           NaN  
...           ...           ...  
13940         NaN           NaN  
13941         NaN           NaN  
13942         NaN           NaN  
13943         NaN           NaN  
13944         NaN           NaN  

[13945 rows x 10 columns]]
[2023-11-06 18:59:01,521: INFO: common: Result dict made ]
[2023-11-06 18:59:01,557: INFO: 2607240163: JSON data_extracted and splitted]
[2023-11-06 19:01:16,365: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 19:01:16,367: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 19:01:16,368: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 19:01:16,368: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 19:01:16,369: INFO: common: created directory at: artifacts_root]
[2023-11-06 19:01:16,369: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 19:01:38,065: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 6B32:463A:1FFFEF6:2185FF3:654932FB
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 19:01:16 GMT
Via: 1.1 varnish
X-Served-By: cache-man4124-MAN
X-Cache: HIT
X-Cache-Hits: 0
X-Timer: S1699297276.368566,VS0,VE174
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: ab716c4fa5e4955c689caebf93b1e64531f625bf
Expires: Mon, 06 Nov 2023 19:06:16 GMT
Source-Age: 0

]
[2023-11-06 19:01:38,065: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 19:01:38,065: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 19:01:38,067: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 19:01:38,067: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 19:01:38,067: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 19:01:38,069: INFO: common: created directory at: artifacts_root]
[2023-11-06 19:01:38,070: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 19:01:38,376: INFO: common: Data frame created for attack types ]
[2023-11-06 19:01:38,511: INFO: common: Data frame created for malwares ]
[2023-11-06 19:01:38,685: INFO: common: Data frame created for relationship types ]
[2023-11-06 19:01:38,845: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 19:01:38,979: INFO: common: Data frame created for campaign types ]
[2023-11-06 19:01:38,979: INFO: common: Data frames creation done ]
[2023-11-06 19:01:38,998: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 19:01:39,027: INFO: common: Table operations performed ]
[2023-11-06 19:01:39,027: INFO: common:                                                attack_id  ... campaign_name
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
...                                                  ...  ...           ...
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...  ...           NaN
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN

[13945 rows x 10 columns]]
[2023-11-06 19:01:39,556: INFO: common: Result dict made ]
[2023-11-06 19:01:39,587: INFO: data_transformation: JSON data_extracted and splitted]
[2023-11-06 19:01:39,592: INFO: main: >>>>>>>> Stage Completed : DATA TRANSFORMATION]
[2023-11-06 19:08:52,568: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 19:08:52,569: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 19:08:52,569: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 19:08:52,570: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 19:08:52,570: INFO: common: created directory at: artifacts_root]
[2023-11-06 19:08:52,571: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 19:09:23,716: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 6B32:463A:1FFFEF6:2185FF3:654932FB
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 19:08:52 GMT
Via: 1.1 varnish
X-Served-By: cache-man4131-MAN
X-Cache: HIT
X-Cache-Hits: 0
X-Timer: S1699297733.631053,VS0,VE167
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: 28d2cfdcdd6f706d8226d02426cd8d656ffca12a
Expires: Mon, 06 Nov 2023 19:13:52 GMT
Source-Age: 0

]
[2023-11-06 19:09:23,716: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 19:09:23,716: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 19:09:23,718: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 19:09:23,718: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 19:09:23,719: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 19:09:23,719: INFO: common: created directory at: artifacts_root]
[2023-11-06 19:09:23,719: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 19:09:24,352: INFO: common: Data frame created for malwares ]
[2023-11-06 19:09:24,509: INFO: common: Data frame created for relationship types ]
[2023-11-06 19:09:24,650: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 19:09:24,798: INFO: common: Data frame created for campaign types ]
[2023-11-06 19:09:24,798: INFO: common: Data frames creation done ]
[2023-11-06 19:09:24,812: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 19:09:24,838: INFO: common: Table operations performed ]
[2023-11-06 19:09:24,838: INFO: common:                                                attack_id  ... campaign_name
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
...                                                  ...  ...           ...
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...  ...           NaN
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN

[13945 rows x 10 columns]]
[2023-11-06 19:09:25,444: INFO: common: Result dict made ]
[2023-11-06 19:09:25,487: INFO: data_transformation: JSON data_extracted and splitted]
[2023-11-06 19:09:25,493: INFO: main: >>>>>>>> Stage Completed : DATA TRANSFORMATION]
[2023-11-06 23:31:21,454: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 23:31:21,456: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 23:31:21,457: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 23:31:21,457: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 23:31:21,458: INFO: common: created directory at: artifacts_root]
[2023-11-06 23:31:21,458: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 23:31:30,100: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 867A:A498:20C107A:226A356:65497747
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 23:31:23 GMT
Via: 1.1 varnish
X-Served-By: cache-man4137-MAN
X-Cache: MISS
X-Cache-Hits: 0
X-Timer: S1699313482.557296,VS0,VE2166
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: 630cdd8acfbb7aa59a445fec914dd2983cfb0e51
Expires: Mon, 06 Nov 2023 23:36:23 GMT
Source-Age: 2

]
[2023-11-06 23:31:30,100: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 23:31:30,102: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 23:31:30,103: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 23:31:30,103: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 23:31:30,103: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 23:31:30,104: INFO: common: created directory at: artifacts_root]
[2023-11-06 23:31:30,104: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 23:31:30,594: ERROR: main: 'NoneType' object has no attribute 'reset_index']
Traceback (most recent call last):
  File "d:\ESP_workspace\ESP\main.py", line 25, in <module>
    obj.main()
  File "d:\ESP_workspace\ESP\src\mlProject\pipeline\data_transformation.py", line 15, in main
    data_transformation.extract_split()
  File "d:\ESP_workspace\ESP\src\mlProject\components\data_transformation.py", line 17, in extract_split
    df_attack, df_campaign, df_intrusion, df_malware, df_relationship = load_create_df(Path(self.config.data_file))
                                                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\umair\anaconda3\envs\ESP_env\Lib\site-packages\ensure\main.py", line 835, in __call__
    return self.f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\ESP_workspace\ESP\src\mlProject\utils\common.py", line 166, in load_create_df
    df_attack_LA.to_csv('attack.csv').reset_index(drop=True)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'reset_index'
[2023-11-06 23:35:33,829: INFO: main: >>>>>>>>> Stage started : DATA INGESTION ]
[2023-11-06 23:35:33,831: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 23:35:33,832: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 23:35:33,832: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 23:35:33,833: INFO: common: created directory at: artifacts_root]
[2023-11-06 23:35:33,833: INFO: common: created directory at: artifacts/data_ingestion]
[2023-11-06 23:35:40,277: INFO: data_ingestion: artifacts/data_ingestion/data.json download! with following info: 
Connection: close
Content-Length: 41774949
Cache-Control: max-age=300
Content-Security-Policy: default-src 'none'; style-src 'unsafe-inline'; sandbox
Content-Type: text/plain; charset=utf-8
ETag: "971d15a599178b750ad79e812a0109cbed43a9c7e041cbcfa2d1c909177de098"
Strict-Transport-Security: max-age=31536000
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-XSS-Protection: 1; mode=block
X-GitHub-Request-Id: 867A:A498:20C107A:226A356:65497747
Accept-Ranges: bytes
Date: Mon, 06 Nov 2023 23:35:33 GMT
Via: 1.1 varnish
X-Served-By: cache-man4127-MAN
X-Cache: HIT
X-Cache-Hits: 0
X-Timer: S1699313734.790258,VS0,VE1
Vary: Authorization,Accept-Encoding,Origin
Access-Control-Allow-Origin: *
Cross-Origin-Resource-Policy: cross-origin
X-Fastly-Request-ID: a9a333b55a3782af58c84169351923096df85335
Expires: Mon, 06 Nov 2023 23:40:33 GMT
Source-Age: 252

]
[2023-11-06 23:35:40,277: INFO: main: >>>>>>>> Stage Completed : DATA INGESTION ]
[2023-11-06 23:35:40,277: INFO: main: >>>>>>>>> Stage started : DATA TRANSFORMATION]
[2023-11-06 23:35:40,278: INFO: common: yaml file: config\config.yaml loaded successfully]
[2023-11-06 23:35:40,278: INFO: common: yaml file: params.yaml loaded successfully]
[2023-11-06 23:35:40,279: INFO: common: yaml file: schema.yaml loaded successfully]
[2023-11-06 23:35:40,279: INFO: common: created directory at: artifacts_root]
[2023-11-06 23:35:40,279: INFO: common: created directory at: artifacts/data_transformation]
[2023-11-06 23:35:40,929: INFO: common: Data frame created for malwares ]
[2023-11-06 23:35:41,129: INFO: common: Data frame created for relationship types ]
[2023-11-06 23:35:41,267: INFO: common: Data frame created for intrusion-sets]
[2023-11-06 23:35:41,572: INFO: common: Data frame created for campaign types ]
[2023-11-06 23:35:41,715: INFO: common: Data frames creation done ]
[2023-11-06 23:35:41,729: INFO: data_transformation: Data_extracted and splitted]
[2023-11-06 23:35:41,757: INFO: common: Table operations performed ]
[2023-11-06 23:35:41,758: INFO: common:                                                attack_id  ... campaign_name
0      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
1      attack-pattern--0042a9f5-f053-4769-b3ef-9ad018...  ...           NaN
2      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
3      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
4      attack-pattern--005a06c6-14bf-4118-afa0-ebcd8a...  ...           NaN
...                                                  ...  ...           ...
13940  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13941  attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c...  ...           NaN
13942  attack-pattern--ffe742ed-9100-4686-9e00-c331da...  ...           NaN
13943  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN
13944  attack-pattern--ffeb0780-356e-4261-b036-cfb6bd...  ...           NaN

[13945 rows x 10 columns]]
[2023-11-06 23:35:42,362: INFO: common: Result dict made ]
[2023-11-06 23:35:42,393: INFO: data_transformation: JSON data_extracted and splitted]
[2023-11-06 23:35:42,397: INFO: main: >>>>>>>> Stage Completed : DATA TRANSFORMATION]
